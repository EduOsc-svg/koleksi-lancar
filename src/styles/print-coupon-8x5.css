/* ========================================
   PRINT COUPON VOUCHER - A4 LANDSCAPE
   ======================================== 
   
   PURPOSE: A4 Landscape Layout untuk cetak kupon angsuran
   PAPER SIZE: A4 Landscape (297mm x 210mm)
   GRID: 3 Kolom x 3 Baris = 9 Voucher per halaman
   VOUCHER SIZE: 9.3cm x 6.3cm per voucher
   GAP: 1mm antar voucher
   MARGIN: 5mm (safe area printer)
   
   NOTE: Tanpa header/kop surat (dicetak di kertas pre-printed)
   
   ======================================== */

/* ==========================================
   WRAPPER UNTUK SEMUA PRINT PAGES
   ========================================== */
.print-coupon-wrapper {
  display: block;
}

/* ==========================================
   MODE SCREEN - PREVIEW SIMULASI KERTAS A4
   ========================================== */
.print-coupon-8x5-container {
  display: block;
  width: 297mm;
  height: 210mm;
  margin: 20px auto;
  background: white;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
  border-radius: 4px;
  position: relative;
  background-color: #f8f9fa;
  border: 1px solid #dee2e6;
  overflow: hidden;
}

/* Container dalam kertas dengan margin 5mm */
.print-coupon-8x5-container::before {
  content: '';
  position: absolute;
  top: 5mm;
  left: 5mm;
  right: 5mm;
  bottom: 5mm;
  background: white;
  border: 1px dashed #ccc;
  pointer-events: none;
  z-index: 0;
}

/* ==========================================
   GRID LAYOUT PRESISI TINGGI
   ========================================== */
.coupon-8x5-grid {
  display: grid;
  grid-template-columns: repeat(3, 93mm);
  grid-template-rows: repeat(3, 63mm);
  gap: 1mm;
  position: absolute;
  top: 5mm;
  left: 5mm;
  z-index: 1;
  width: calc(3 * 93mm + 2 * 1mm);
  height: calc(3 * 63mm + 2 * 1mm);
}

/* ==========================================
   VOUCHER CARD
   ========================================== */
.coupon-8x5-card {
  width: 93mm;
  height: 63mm;
  position: relative;
  background: white;
  border: none;
  
  /* Background image voucher (pre-printed template) */
  background-image: url('/Background with WM.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  
  overflow: visible;
}

/* Cut Lines - Garis Potong Vertikal (Kanan) */
.coupon-8x5-card::after {
  content: '';
  position: absolute;
  right: -1.5mm;
  top: -1mm;
  bottom: -1mm;
  width: 1px;
  background: repeating-linear-gradient(
    to bottom,
    #999 0,
    #999 2mm,
    transparent 2mm,
    transparent 4mm
  );
  z-index: 10;
}

/* Cut Lines - Garis Potong Horizontal (Bawah) */
.coupon-8x5-card::before {
  content: '';
  position: absolute;
  bottom: -1.5mm;
  left: -1mm;
  right: -1mm;
  height: 1px;
  background: repeating-linear-gradient(
    to right,
    #999 0,
    #999 2mm,
    transparent 2mm,
    transparent 4mm
  );
  z-index: 10;
}

/* Hilangkan garis di tepi kanan (kolom ke-3) */
.coupon-8x5-card:nth-child(3n)::after {
  display: none;
}

/* Hilangkan garis di tepi bawah (baris ke-3) */
.coupon-8x5-card:nth-child(n+7)::before {
  display: none;
}

/* ==========================================
   CONTENT POSITIONING - DATA VOUCHER
   Tanpa header, langsung konten data
   ========================================== */
.coupon-8x5-data {
  position: absolute;
  font-family: 'Arial', sans-serif;
  font-size: 10pt;
  line-height: 1.3;
  color: #000;
  font-weight: bold;
  z-index: 5;
  white-space: nowrap;
}

/* NO.Faktur - Posisi atas kiri */
.coupon-8x5-faktur {
  top: 18mm;
  left: 5mm;
  width: 50mm;
  font-size: 9pt;
}

/* Nama Customer */
.coupon-8x5-nama {
  top: 25mm;
  left: 5mm;
  width: 50mm;
  font-size: 9pt;
}

/* Alamat Usaha */
.coupon-8x5-alamat {
  top: 32mm;
  left: 5mm;
  width: 55mm;
  font-size: 8pt;
  font-weight: normal;
  white-space: normal;
  line-height: 1.2;
}

/* Tanggal Jatuh Tempo */
.coupon-8x5-jatuhtempo {
  top: 40mm;
  left: 5mm;
  width: 45mm;
  font-size: 9pt;
}

/* Angsuran Ke- */
.coupon-8x5-angsuran-ke {
  top: 47mm;
  left: 5mm;
  width: 40mm;
  font-size: 9pt;
}

/* Nominal Angsuran - Bagian kanan bawah */
.coupon-8x5-nominal {
  top: 30mm;
  right: 5mm;
  width: 28mm;
  text-align: right;
  font-size: 12pt;
  font-weight: bold;
  color: #000;
}

/* ==========================================
   RESPONSIVE ADJUSTMENTS
   ========================================== */
@media screen and (max-width: 1200px) {
  .print-coupon-8x5-container {
    transform: scale(0.7);
    transform-origin: center top;
  }
}

@media screen and (max-width: 900px) {
  .print-coupon-8x5-container {
    transform: scale(0.5);
  }
}

/* ==========================================
   MODE PRINT - PRESISI TINGGI
   ========================================== */
@media print {
  /* Reset all elements */
  * {
    box-sizing: border-box !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }

  /* Page setup */
  @page {
    size: A4 landscape;
    margin: 0;
  }

  /* Hide everything except print content */
  html, body {
    width: 297mm !important;
    height: auto !important;
    margin: 0 !important;
    padding: 0 !important;
    background: white !important;
    overflow: visible !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Hide ALL other content except print wrapper */
  body > *:not(.print-coupon-wrapper),
  body > div:not(.print-coupon-wrapper),
  header, nav, aside, footer,
  .sidebar, .navbar, .menu,
  [class*="sidebar"], [class*="nav"],
  [data-state], [role="dialog"],
  .print\\:hidden {
    display: none !important;
    visibility: hidden !important;
  }

  /* Show print wrapper */
  .print-coupon-wrapper {
    display: block !important;
    visibility: visible !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 297mm !important;
    z-index: 999999 !important;
    background: white !important;
  }

  /* Each page container */
  .print-coupon-8x5-container {
    display: block !important;
    position: relative !important;
    width: 297mm !important;
    height: 210mm !important;
    margin: 0 !important;
    padding: 0 !important;
    background: white !important;
    box-shadow: none !important;
    border: none !important;
    border-radius: 0 !important;
    transform: none !important;
    overflow: visible !important;
    
    /* Page break control */
    page-break-after: always !important;
    break-after: page !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* Last page - no break after */
  .print-coupon-8x5-container:last-child {
    page-break-after: auto !important;
    break-after: auto !important;
  }

  /* Hide dashed border indicator */
  .print-coupon-8x5-container::before {
    display: none !important;
  }

  /* Grid positioning */
  .coupon-8x5-grid {
    display: grid !important;
    position: absolute !important;
    top: 5mm !important;
    left: 5mm !important;
    width: calc(3 * 93mm + 2 * 1mm) !important;
    height: calc(3 * 63mm + 2 * 1mm) !important;
    grid-template-columns: repeat(3, 93mm) !important;
    grid-template-rows: repeat(3, 63mm) !important;
    gap: 1mm !important;
    z-index: 1 !important;
  }

  /* Voucher card printing */
  .coupon-8x5-card {
    width: 93mm !important;
    height: 63mm !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    background-size: cover !important;
    background-position: center !important;
    background-repeat: no-repeat !important;
  }
  
  /* Data text printing */
  .coupon-8x5-data {
    font-family: 'Arial', 'Helvetica', sans-serif !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color: #000 !important;
  }

  /* Hide cut lines in print */
  .coupon-8x5-card::after,
  .coupon-8x5-card::before {
    display: none !important;
  }
}
