/* ========================================
   VOUCHER PRINT STYLES - PRINT ONLY MODE
   Based on backup/print-a4-landscape.css
   ======================================== */

/* Reset standar */
* { margin: 0; padding: 0; box-sizing: border-box; }

/* Screen preview with actual voucher display */
@media screen {
    /* Hidden print container - tidak tampil di screen */
    .voucher-print-container {
        display: none !important;
    }
    
    /* Preview container - hanya untuk screen preview */
    .voucher-preview-container {
        display: block !important;
        margin: 20px auto;
    }
    
    .voucher-preview-grid {
        display: grid !important;
        grid-template-columns: repeat(3, 1fr) !important;
        grid-template-rows: repeat(3, 1fr) !important;
        gap: 15px !important;
        justify-items: center !important;
        align-items: center !important;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
        border: 2px dashed #dee2e6;
    }
    
    /* Voucher card preview styling - smaller scale for screen */
    .voucher-preview-grid .voucher-card,
    .voucher-preview-grid .voucher-container {
        width: 240px !important; /* Scaled down from 80mm */
        height: 150px !important; /* Scaled down from 50mm */
        position: relative !important;
        background-image: url('/Background with WM.png') !important;
        background-size: cover !important;
        background-position: center !important;
        background-repeat: no-repeat !important;
        border: 1px solid #ddd !important;
        border-radius: 4px !important;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
        font-family: "Times New Roman", Times, serif !important;
        display: block !important;
        overflow: hidden !important;
    }
    
    /* Preview field styling */
    .voucher-preview-grid .field-item {
        position: absolute !important;
        font-family: "Times New Roman", Times, serif !important;
        color: #333 !important;
        font-weight: normal !important;
        white-space: nowrap !important;
        display: block !important;
        visibility: visible !important;
    }
    
    /* Preview positioning (scaled down) */
    .voucher-preview-grid .judul-voucer {
        top: 25% !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
        font-size: 11px !important;
        font-weight: bold !important;
    }
    
    .voucher-preview-grid .row-1 .nilai-field { top: 37.5% !important; left: 23% !important; font-size: 9px !important; }
    .voucher-preview-grid .row-2 .nilai-field { top: 45.5% !important; left: 23% !important; font-size: 9px !important; }
    .voucher-preview-grid .row-3 .nilai-field { top: 53.5% !important; left: 23% !important; font-size: 8px !important; }
    .voucher-preview-grid .row-4 .nilai-field { top: 61.5% !important; left: 32% !important; font-size: 9px !important; }
    .voucher-preview-grid .row-5 .nilai-field { top: 69.5% !important; left: 32% !important; font-size: 9px !important; }
    
    .voucher-preview-grid .nilai-angsuran {
        top: 78% !important;
        left: 73% !important;
        font-size: 10px !important;
        font-weight: normal !important;
        text-align: left !important;
    }
    
    .voucher-preview-grid .label-kantor {
        top: 87% !important;
        left: 45% !important;
        font-size: 8px !important;
        font-weight: normal !important;
    }
    
    /* Empty voucher preview */
    .voucher-preview-grid .voucher-empty {
        background: #f8f8f8 !important;
        border: 2px dashed #ccc !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        color: #999 !important;
        font-size: 12px !important;
    }
    
    .voucher-preview-grid .voucher-empty::after {
        content: "Empty Slot" !important;
    }
}

/* Utility classes */
.print-only { display: none; }

/* Container hanya untuk print */
.voucher-print-container {
  display: none;
}

/* --- MODE CETAK (PRINT ONLY) --- */
@media print {
    .print-only { display: block !important; }
    
    @page {
        size: A4 landscape;
        margin: 5mm;
    }
    
    /* Reset body */
    body {
        margin: 0 !important;
        padding: 0 !important;
        background: white !important;
        font-family: "Times New Roman", serif;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }
    
    /* Hide non-print elements */
    body > *:not(.voucher-print-container) {
        display: none !important;
    }
    
    /* Show only print container and force visibility */
    .voucher-print-container {
        display: block !important;
        visibility: visible !important;
        width: 100% !important;
        height: auto !important;
        position: relative !important;
    }
    
    .voucher-print-container * {
        visibility: visible !important;
    }
    
    /* Halaman A4 Landscape */
    .voucher-page { 
        background-color: white !important;
        width: 100% !important;
        height: auto !important;
        padding: 15mm !important;
        margin: 0 !important;
        display: block !important;
        page-break-after: always !important;
    }
    
    .voucher-page:last-child {
        page-break-after: avoid !important;
    }
    
    /* Grid Layout 3x3 */
    .voucher-grid { 
        display: grid !important; 
        grid-template-columns: repeat(3, 1fr) !important;
        grid-template-rows: repeat(3, 1fr) !important;
        gap: 10mm !important;
        justify-items: center !important;
        align-items: center !important;
        width: 100% !important;
        height: auto !important;
        visibility: visible !important;
    }
    
    /* --- VOUCHER CONTAINER --- */
    .voucher-card, .voucher-container {
        width: 80mm !important;
        height: 50mm !important;
        position: relative !important;
        background-image: url('/Background with WM.png') !important;
        background-size: 100% 100% !important;
        background-repeat: no-repeat !important;
        font-family: "Times New Roman", Times, serif !important;
        color: #333 !important;
        font-size: 10pt !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Background Image (not used in print, using CSS background-image instead) */
    .voucher-bg {
        display: none;
    }

    /* Styling Umum untuk Semua Field Teks */
    .field-item {
        position: absolute !important;
        white-space: nowrap !important;
        font-family: "Times New Roman", Times, serif !important;
        color: #333 !important;
        font-weight: normal !important;
        display: block !important;
        visibility: visible !important;
    }

    /* --- POSITIONING SESUAI BACKUP FILE --- */
    
    /* Judul Tengah */
    .judul-voucer {
        top: 25% !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
        font-size: 11pt !important;
        font-weight: bold !important;
        color: #333 !important;
    }

    /* --- Field Labels dan Values --- */
    .label-kiri {
        font-weight: normal !important;
        font-size: 9pt !important;
        left: 5% !important;
        color: #333 !important;
    }
    .titik-dua {
        font-weight: normal !important;
        font-size: 9pt !important;
        left: 22% !important;
        color: #333 !important;
    }
    
    /* Nilai Field dengan positioning sesuai backup */
    .nilai-field {
        font-weight: normal !important;
        font-size: 9pt !important;
        color: #333 !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        display: block !important;
    }

    /* Positioning sesuai backup file */
    .row-1 .nilai-field { top: 37.5% !important; left: 23% !important; }  /* NO.Faktur */
    .row-2 .nilai-field { top: 45.5% !important; left: 23% !important; }  /* Nama */
    .row-3 .nilai-field { top: 53.5% !important; left: 23% !important; font-size: 8pt !important; } /* Alamat */
    .row-4 .nilai-field { top: 61.5% !important; left: 32% !important; }  /* Jatuh Tempo */
    .row-5 .nilai-field { top: 69.5% !important; left: 32% !important; }  /* Angsuran Ke- */

    /* Hide labels in print mode (data only) */
    .label-kiri, .titik-dua {
        display: none !important;
    }

    /* --- Bagian Angsuran (Besar Angsuran) --- */
    .label-besar-angsuran {
        display: none !important; /* Hide label */
    }
    .label-rp {
        display: none !important; /* Hide Rp label */
    }
    
    /* Nilai Angsuran - positioning sesuai backup */
    .nilai-angsuran {
        top: 78% !important;
        left: 73% !important;
        font-size: 12pt !important;
        font-weight: normal !important;
        color: #333 !important;
        text-align: left !important;
        display: block !important;
        visibility: visible !important;
    }
    
    /* Hide garis */
    .garis-input-rp {
        display: none !important;
    }

    /* --- Info Kantor --- */
    .label-kantor {
        top: 87% !important;
        left: 45% !important;
        font-size: 9pt !important;
        font-weight: normal !important;
        color: #333 !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Empty voucher styling */
    .voucher-empty {
        background: none;
        border: 1px dashed #ccc;
    }
}