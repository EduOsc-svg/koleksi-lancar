/* ========================================
   VOUCHER PRINT STYLES - FINAL POSITIONS
   ======================================== */

/* Reset standar */
* { margin: 0; padding: 0; box-sizing: border-box; }

/* Utility classes */
.print-only { display: none; }

/* --- MODE CETAK (PRINT) --- */
@media print {
    .print-only { display: block; }
    
    @page {
        size: A4 landscape;
        margin: 3mm;
    }
    
    html, body { 
        margin: 0; 
        padding: 0; 
        background: white; 
        -webkit-print-color-adjust: exact; 
        print-color-adjust: exact; 
        height: auto; /* Pastikan body tidak memaksa tinggi */
    }
    
    body * { visibility: hidden; }
    .voucher-print-container, .voucher-print-container * { visibility: visible; }
    
    .voucher-print-container { 
        position: absolute; 
        left: 0; 
        top: 0; 
        width: 100%; 
        height: auto; /* Tambahkan height auto */
    }
    
    /* Halaman A4 Landscape */
    .voucher-page { 
        width: 297mm; 
        height: auto; /* Ubah dari 210mm ke auto */
        min-height: 200mm; /* Minimum height untuk memastikan grid fit */
        margin: 0; 
        padding: 2mm; 
        page-break-after: auto; /* Ubah dari always ke auto */
        page-break-inside: avoid; /* Hindari page break di tengah voucher page */
        position: relative; 
        background: white; 
        overflow: visible; /* Ubah dari hidden ke visible */
    }
    .voucher-page:last-child { page-break-after: avoid; }
    
    /* Pastikan page break hanya terjadi antar voucher page */
    .voucher-page + .voucher-page { 
        page-break-before: always; 
    }
    
    /* Grid Layout 3x3 (Ukuran Diperkecil) */
    .voucher-grid { 
        display: grid; 
        grid-template-columns: repeat(3, 9.2cm); /* Kurangi 0.3cm dari 9.5cm */
        grid-template-rows: repeat(3, 6.2cm); /* Kurangi 0.3cm dari 6.5cm */ 
        justify-content: center; 
        align-content: start; /* Ubah dari center ke start */
        width: 100%;
        height: auto; /* Ubah dari 100% ke auto */
        padding: 1mm;
    }
    
    /* Kartu Voucher */
    .voucher-card { 
        width: 9.2cm; /* Kurangi 0.3cm dari 9.5cm */
        height: 6.2cm; /* Kurangi 0.3cm dari 6.5cm */
        position: relative; 
        background-size: 100% 100%; 
        background-repeat: no-repeat; 
        background-position: center; 
        border: 2px dashed #666; /* Garis potong 2px, warna lebih gelap */ 
       }
    
    /* Background Variation */
    .voucher-normal { background-image: url('/Voucher background Hitam.png'); }
    .voucher-urgent { background-image: url('/Voucher backround Merah.png'); }
    
    /* Styling Text Dasar */
    .voucher-field { 
        position: absolute; 
        font-family: 'Times New Roman', Times, serif; 
        font-weight: normal; 
        line-height: 1.2; 
        overflow: hidden; 
        text-overflow: ellipsis; 
        white-space: nowrap; 
    }
    
    /* Warna Font */
    .voucher-normal .voucher-field { color: #000000; }
    .voucher-urgent .voucher-field { color: #CC0000; }
    
    /* Pengecualian Warna (Selalu Merah) */
    .voucher-normal .installment-amount, .voucher-urgent .installment-amount,
    .voucher-normal .installment-number, .voucher-urgent .installment-number,
    .voucher-normal .company-info, .voucher-urgent .company-info { color: #CC0000; }

    /* Pengecualian Warna untuk Title (Selalu Hitam) */
    .voucher-normal .voucher-title, .voucher-urgent .voucher-title { 
        color: #000000 !important; 
        font-weight: bold;
    }

    /* --- POSISI DATA (DARI REQUEST TERBARU ANDA) --- */
    
    /* Voucher Title - "Voucher Angsuran - Contract Ref" */
    .voucher-title {
        right: 23px;
        top: 80px;
        font-size: 17px;
        font-weight: bold;
        max-width: 80%;
        color: #000000;
    }
    
    /* NO.Faktur */
    .no-faktur {
        left: 109px;
        top: 85px;
        font-size: 14px;
        max-width: 65%;
    }

    /* Customer Name */
    .customer-name {
        left: 109px;
        top: 99px;
        font-size: 14px;
        max-width: 65%;
    }

    /* Customer Address */
    .customer-address {
        left: 109px;
        top: 114px;
        font-size: 14px;
        max-width: 65%;
    }

    /* Due Date */
    .due-date {
        left: 110px;
        top: 128px;
        font-size: 14px;
        max-width: 65%;
    }

    /* Installment Number */
    .installment-number {
        left: 190px;
        top: 140px;
        font-size: 14px;
        max-width: 20%;
    }

    /* Installment Amount */
    .installment-amount {
        right: 12%;
        top: 169px;
        font-size: 14px;
        text-align: right;
        max-width: 35%;
    }

    /* Company Info */
    .company-info {
        left: 170px;
        bottom: 21px;
        font-size: 15px;
        color: #CC0000;
        max-width: 90%;
    }
}

/* --- CSS untuk voucher di screen --- */
@media screen {
    .voucher-print-container { 
        position: fixed;
        left: -9999px;
        top: -9999px;
        width: 297mm;
        height: 210mm;
        background: white;
    }
}